<div class="container mt-4">
  <!-- Search Bar -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Search events..." [(ngModel)]="searchTerm" (keyup.enter)="searchEvents()">
        <button class="btn btn-primary" (click)="searchEvents()">
          <i class="fas fa-search"></i> Search
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="alert alert-danger" role="alert">
    {{ error }}
  </div>

  <!-- Current Events Section -->
  <div *ngIf="currentEvents.length > 0" class="mb-5">
    <h2 class="section-title mb-4">Happening Now</h2>
    <div class="row">
      <div *ngFor="let event of currentEvents" class="col-md-4 mb-4">
        <div class="card event-card h-100">
          <img [src]="getImageUrl(event.imagePath || '')" class="card-img-top" [alt]="event.title">
          <div class="card-body">
            <h5 class="card-title">{{ event.title }}</h5>
            <p class="card-text">{{ event.description }}</p>
            <div class="event-details">
              <div class="menu-section">
                <h6>{{ getPriceDisplay(event).menuName }}</h6>
              </div>
              <div class="price-section">
                <div *ngIf="getPriceDisplay(event).hasDiscount" class="discount-badge">
                  {{ getPriceDisplay(event).discountPercentage }}% OFF
                </div>
                <div class="price-row">
                  <span class="price-label">Original Price:</span>
                  <span class="original-price">${{ getPriceDisplay(event).original }}</span>
                </div>
                <div class="price-row">
                  <span class="price-label">Discounted Price:</span>
                  <span class="current-price">${{ getPriceDisplay(event).discounted }}</span>
                </div>
                <div *ngIf="getPriceDisplay(event).hasDiscount" class="price-row">
                  <span class="price-label">You Save:</span>
                  <span class="savings">${{ getPriceDisplay(event).savings }}</span>
                </div>
              </div>
              <div class="event-dates">
                <small class="text-muted">
                  <i class="fas fa-calendar"></i> 
                  {{ event.startDate | date:'mediumDate' }} - {{ event.endDate | date:'mediumDate' }}
                </small>
              </div>
            </div>
          </div>
          <div class="card-footer">
            <button class="btn btn-primary me-2" (click)="registerForEvent(event)">
              Register
            </button>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Upcoming Events Section -->
  <div *ngIf="upcomingEvents.length > 0">
    <h2 class="section-title mb-4">Upcoming Events</h2>
    <div class="row">
      <div *ngFor="let event of upcomingEvents" class="col-md-4 mb-4">
        <div class="card event-card h-100">
          <img [src]="getImageUrl(event.imagePath || '')" class="card-img-top" [alt]="event.title">
          <div class="card-body">
            <h5 class="card-title">{{ event.title }}</h5>
            <p class="card-text">{{ event.description }}</p>
            <div class="event-details">
              <div class="menu-section">
                <h6>{{ getPriceDisplay(event).menuName }}</h6>
              </div>
              <div class="price-section">
                <div *ngIf="getPriceDisplay(event).hasDiscount" class="discount-badge">
                  {{ getPriceDisplay(event).discountPercentage }}% OFF
                </div>
                <div class="price-row">
                  <span class="price-label">Original Price:</span>
                  <span class="original-price">${{ getPriceDisplay(event).original }}</span>
                </div>
                <div class="price-row">
                  <span class="price-label">Discounted Price:</span>
                  <span class="current-price">${{ getPriceDisplay(event).discounted }}</span>
                </div>
                <div *ngIf="getPriceDisplay(event).hasDiscount" class="price-row">
                  <span class="price-label">You Save:</span>
                  <span class="savings">${{ getPriceDisplay(event).savings }}</span>
                </div>
              </div>
              <div class="event-dates">
                <small class="text-muted">
                  <i class="fas fa-calendar"></i> 
                  {{ event.startDate | date:'mediumDate' }} - {{ event.endDate | date:'mediumDate' }}
                </small>
                <div class="days-left">
                  <i class="fas fa-clock"></i> 
                  {{ calculateDaysLeft(event.endDate) }} days left
                </div>
              </div>
            </div>
          </div>
          <div class="card-footer">
            <button class="btn btn-primary me-2" (click)="registerForEvent(event)">
              Register
            </button>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Events Message -->
  <div *ngIf="!isLoading && events.length === 0" class="text-center">
    <p class="lead">No events found. Try adjusting your search or check back later.</p>
  </div>
</div>