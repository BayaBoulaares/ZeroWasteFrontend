

<div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">Welcome  /</span> Restaurant </h4>

    <hr class="my-5">

    <div class="container mt-5">

     
 
    <!--btn ajout + form ajout -->
    <div class="card mb-4">
        <h5 class="card-header">Tools</h5>
        

        
        <hr class="m-0"> 
        
        
       <div class="card-body">

         <!-- üîç Search bar -->
      <div class="row mb-3 justify-content-center">
        <div class="col-md-6">
          <input
            type="text"
            class="form-control"
            placeholder="Search by name, location, or cuisine..."
            [(ngModel)]="searchKeyword"
            (input)="searchRestaurant()"
          />
        </div>
      </div>

      
          <div class="row gy-1">
            <!-- Modal Sizes -->
            <div class="col-lg-4 col-md-6">
              <!-- Small Modal -->

              <div class="modal fade" id="smallModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                  <div class="modal-content">
              
                    <div class="modal-header">
                      <h5 class="modal-title">Restaurant Details</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
              
                    <div class="modal-body">
                      <form [formGroup]="restaurantForm">
                        <div class="row mb-3">
                          <div class="col">
                            <label class="form-label">Name</label>
                            <input type="text" class="form-control" formControlName="name" placeholder="Restaurant Name">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('name')?.invalid && restaurantForm.get('name')?.touched">
                              <span *ngIf="restaurantForm.get('name')?.errors?.['required']">Le nom est obligatoire.</span>
                              <span *ngIf="restaurantForm.get('name')?.errors?.['pattern']">Le nom doit commencer par une majuscule et ne contenir que des lettres.</span>
                            </div>
                          </div>
              
                          <div class="col">
                            <label class="form-label">Location</label>
                            <input type="text" class="form-control" formControlName="location" placeholder="Address / City">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('location')?.invalid && restaurantForm.get('location')?.touched">
                              <span>La localisation est obligatoire.</span>
                            </div>
                          </div>
                        </div>
              
                        <div class="row mb-3">
                          <div class="col">
                            <label class="form-label">Cuisine Type</label>
                            <input type="text" class="form-control" formControlName="cuisineType" placeholder="e.g., Italian, Asian">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('cuisineType')?.invalid && restaurantForm.get('cuisineType')?.touched">
                              <span>Le type de cuisine est obligatoire.</span>
                            </div>
                          </div>
              
                          <div class="col">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" formControlName="phoneNumber" placeholder="+1234567890">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('phoneNumber')?.invalid && restaurantForm.get('phoneNumber')?.touched">
                              <span>Le num√©ro de t√©l√©phone est obligatoire.</span>
                            </div>
                          </div>
                        </div>
              
                        <div class="row mb-3">
                          <div class="col">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" formControlName="email" placeholder="example@domain.com">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('email')?.invalid && restaurantForm.get('email')?.touched">
                              <span>L'adresse e-mail est obligatoire.</span>
                            </div>
                          </div>
              
                          <div class="col">
                            <label class="form-label">Seating Capacity</label>
                            <input type="number" class="form-control" formControlName="seatingCapacity" min="1" placeholder="e.g., 50">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('seatingCapacity')?.invalid && restaurantForm.get('seatingCapacity')?.touched">
                              <span>La capacit√© est obligatoire.</span>
                            </div>
                          </div>
                        </div>
              
                        <div class="row mb-3">
                          <div class="col">
                            <label class="form-label">Opening Time</label>
                            <input type="time" class="form-control" formControlName="openingTime">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('openingTime')?.invalid && restaurantForm.get('openingTime')?.touched">
                              <span>L'heure d'ouverture est obligatoire.</span>
                            </div>
                          </div>
              
                          <div class="col">
                            <label class="form-label">Closing Time</label>
                            <input type="time" class="form-control" formControlName="closingTime">
                            <div class="alert alert-danger" *ngIf="restaurantForm.get('closingTime')?.invalid && restaurantForm.get('closingTime')?.touched">
                              <span>L'heure de fermeture est obligatoire.</span>
                            </div>
                          </div>
                        </div>
              
                        <div class="form-check form-switch mb-3">
                            <input type="checkbox" class="form-check-input"
                                [checked]="restaurantForm.get('isActive')?.value === 'ACTIVE'"
                                (change)="updateActiveStatus($event)"
                                id="isActive">
                          <label class="form-check-label" for="isActive">Is Active</label>
                        </div>
                      </form>
                    </div>
              
                    <div class="modal-footer">
                      <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                      <button type="button" class="btn btn-primary" data-bs-dismiss="modal" (click)="saveRestaurant()" [disabled]="restaurantForm.invalid">Save changes</button>
                    </div>
              
                  </div>
                </div>
              </div>
              

              <div class="demo-inline-spacing">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#smallModal">
                  Add Restaurant
                </button>

              </div>
            </div>

            
            

            
            
          </div>
        </div>
      </div>





      <!-- model update -->
      <div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
      
            <div class="modal-header">
              <h5 class="modal-title">Restaurant Update</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
      
            <div class="modal-body">
              <form [formGroup]="restaurantForm">
                <div class="row mb-3">
                  <div class="col">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-control" formControlName="name" placeholder="Restaurant Name">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('name')?.invalid && restaurantForm.get('name')?.touched">
                      <span *ngIf="restaurantForm.get('name')?.errors?.['required']">Le nom est obligatoire.</span>
                      <span *ngIf="restaurantForm.get('name')?.errors?.['pattern']">Le nom doit commencer par une majuscule et ne contenir que des lettres.</span>
                    </div>
                  </div>
      
                  <div class="col">
                    <label class="form-label">Location</label>
                    <input type="text" class="form-control" formControlName="location" placeholder="Address / City">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('location')?.invalid && restaurantForm.get('location')?.touched">
                      <span>La localisation est obligatoire.</span>
                    </div>
                  </div>
                </div>
      
                <div class="row mb-3">
                  <div class="col">
                    <label class="form-label">Cuisine Type</label>
                    <input type="text" class="form-control" formControlName="cuisineType" placeholder="e.g., Italian, Asian">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('cuisineType')?.invalid && restaurantForm.get('cuisineType')?.touched">
                      <span>Le type de cuisine est obligatoire.</span>
                    </div>
                  </div>
      
                  <div class="col">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" formControlName="phoneNumber" placeholder="+1234567890">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('phoneNumber')?.invalid && restaurantForm.get('phoneNumber')?.touched">
                      <span>Le num√©ro de t√©l√©phone est obligatoire.</span>
                    </div>
                  </div>
                </div>
      
                <div class="row mb-3">
                  <div class="col">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" formControlName="email" placeholder="example@domain.com">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('email')?.invalid && restaurantForm.get('email')?.touched">
                      <span>L'adresse e-mail est obligatoire.</span>
                    </div>
                  </div>
      
                  <div class="col">
                    <label class="form-label">Seating Capacity</label>
                    <input type="number" class="form-control" formControlName="seatingCapacity" min="1" placeholder="e.g., 50">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('seatingCapacity')?.invalid && restaurantForm.get('seatingCapacity')?.touched">
                      <span>La capacit√© est obligatoire.</span>
                    </div>
                  </div>
                </div>
      
                <div class="row mb-3">
                  <div class="col">
                    <label class="form-label">Opening Time</label>
                    <input type="time" class="form-control" formControlName="openingTime">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('openingTime')?.invalid && restaurantForm.get('openingTime')?.touched">
                      <span>L'heure d'ouverture est obligatoire.</span>
                    </div>
                  </div>
      
                  <div class="col">
                    <label class="form-label">Closing Time</label>
                    <input type="time" class="form-control" formControlName="closingTime">
                    <div class="alert alert-danger" *ngIf="restaurantForm.get('closingTime')?.invalid && restaurantForm.get('closingTime')?.touched">
                      <span>L'heure de fermeture est obligatoire.</span>
                    </div>
                  </div>
                </div>
      
                <div class="form-check form-switch mb-3">
                    <input type="checkbox" class="form-check-input"
                        [checked]="restaurantForm.get('isActive')?.value === 'ACTIVE'"
                        (change)="updateActiveStatus($event)"
                        id="isActive">
                  <label class="form-check-label" for="isActive">Is Active</label>
                </div>
              </form>
            </div>
      
            <div class="modal-footer">
              <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary" data-bs-dismiss="modal" (click)="UpdateRestaurant()" [disabled]="restaurantForm.invalid">Save changes</button>
            </div>
      
          </div>
        </div>
      </div>

      <!--model update end -->


      

      <!-- table-->
   <div class="card">
                <h5 class="card-header">Striped rows</h5>
                <div class="table-responsive text-nowrap">
                  <table class="table table-striped">
                    <thead>
                      <tr>
                        <th>Restaurant Name</th>
                        <th>location</th>
                        <th>Seating Capacity</th>
                        <th>Status</th>
                        <th>Actions</th>
                        
                      </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">
                        <tr *ngFor="let restaurant of filteredRestaurants">
                          <td><strong>{{ restaurant?.name }}</strong></td>
                          <td>{{ restaurant?.location }}</td>
                          <td>{{ restaurant?.seatingCapacity }} seats</td>
                          <td>
                            <span class="badge" 
                            [ngClass]="{
                              'bg-success': restaurant.isActive === 'ACTIVE',
                              'bg-warning': restaurant.isActive === 'INACTIVE'
                            }">
                        {{ restaurant.isActive }}
                      </span>
                          </td>
                          <td>
                            <div class="dropdown">
                              <button type="button" class="btn p-0 dropdown-toggle hide-arrow" data-bs-toggle="dropdown">
                                <i class="bx bx-dots-vertical-rounded"></i>
                              </button>
                              <div class="dropdown-menu">
                                <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editModal" (click)="onEdit(restaurant)">
                                  <i class="bx bx-edit-alt me-1"></i> Edit
                                </a>
                                <a class="dropdown-item" href="#" (click)="onDelete(restaurant.restaurantid)">
                                  <i class="bx bx-trash me-1"></i> Delete 
                                </a>
                                <a class="dropdown-item" href="#" [routerLink]="['/admin/RestaurantManagment/RestaurantDetails',restaurant.restaurantid]"  >
                                    <i class="bx bx-dots-horizontal-rounded me-1"></i> Show More {{restaurant.restaurantid}}
                                  </a>
                              </div>
                            </div>
                          </td>
                      </tbody>
                      
                  </table>
                </div>
              </div>

    <hr class="my-5">

    <!-- Add this before the restaurant list/table -->
<div class="row mb-4 justify-content-center">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h5 class="card-title mb-0">Restaurant Cuisine Types Distribution</h5>
      </div>
      <div class="card-body d-flex justify-content-center">
        <div style="width: 100%; max-width: 800px;">
          <canvas *ngIf="cuisineChartData" 
                  baseChart 
                  [type]="'bar'"
                  [data]="cuisineChartData"
                  [options]="cuisineChartOptions">
          </canvas>
        </div>
      </div>
    </div>
  </div>
</div>
    
     
    
   

  </div>